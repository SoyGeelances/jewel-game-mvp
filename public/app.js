(()=>{"use strict";var e={24:e=>{e.exports=Phaser},34:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),o=s(317),n=s(927),r=s(701),c=s(723),l=s(852);class h extends Phaser.Scene{constructor(){super(...arguments),this.withPreview=!0,this.withRestartTime=!0,this.scoreValue=0,this.resizeApplied=!1,this.cellSizeX=80,this.cellSizeY=80,this.flipSpeed=200,this.flipZoom=1.05,this.limitTime=1e4,this.maxTime=6e4,this.baseScale=.6,this.targetScore=1e4,this.splitter={rows:5,columns:6},this.nextLevelTimer=null,this.state="idle",this.previewGoing=!1,this.flippedCards=[],this.levelDificulty=1,this.configDificulty=[[2,2],[2,3],[2,4],[2,5],[3,4],[4,3],[6,3],[4,4],[4,5],[4,5],[5,4],[6,5]]}init(){this.resetGameState(),window&&window.innerHeight<650&&!this.resizeApplied&&(this.resizeApplied=!0,this.cellSizeX=this.cellSizeX/1.6,this.cellSizeY=this.cellSizeY/1.6,this.flipZoom=this.flipZoom/1.6,this.baseScale=this.baseScale/1.6)}preload(){}exist(e){return null!=e}getScoreValue(){return this.scoreValue}resetGameState(){this.scoreValue=0,this.levelDificulty=1,this.state="idle",this.previewGoing=!1}checkMatch(){if(!this.previewGoing){if(this.flippedCards[0].behindFrame===this.flippedCards[1].behindFrame)this.flippedCards[0].disableInteractive(),this.flippedCards[1].disableInteractive(),this.flippedCards[0].pending=!1,this.flippedCards[1].pending=!1,this.tweens.add({targets:this.flippedCards,alpha:0,duration:500,yoyo:!1}),0===this.group.getChildren().filter(e=>e.pending).length&&null==this.nextLevelTimer&&(this.nextLevelTimer=setTimeout(()=>{this.createNextGame(),clearTimeout(this.nextLevelTimer),this.nextLevelTimer=null},550)),this.scoreValue=Number(this.scoreValue)+100+50*this.levelDificulty,"end"!==this.state&&(this.scoreText.setText(this.scoreValue.toString()),this.tweens.add({targets:this.scoreText,y:40,scaleY:1.2,duration:200,ease:"Power1",yoyo:!0,onComplete:()=>{this.tweens.add({targets:this.scoreText,y:55,duration:300,ease:"Bounce.easeOut"})}}),this.sound.add("collectcoin").play());else for(let e=0;e<this.flippedCards.length;e++){const t=this.flippedCards[e];setTimeout(()=>{this.flipTween(t,!0)},200)}this.flippedCards=[]}}flipTween(e,t=!1,s=()=>null,i=!0){!t&&e.isFlipping||(t&&i?e.isFlipping=!1:i&&(e.isFlipping=!0,this.flippedCards.push(e)),this.game.sound.mute||this.sound.add("cardFlip",{volume:.3}).play(),this.tweens.add({targets:e,scaleX:.01,duration:this.flipSpeed/2,yoyo:!1,onComplete:()=>{t?e.setFrame(1):e.setFrame(e.behindFrame),this.tweens.add({targets:e,scaleX:this.baseScale,duration:this.flipSpeed/2,yoyo:!1,onComplete:()=>{s()}})}}))}makeCardInteractive(e){e.setScale(this.baseScale),e.isFlipping=!1,0!=e.frame.name&&(e.setInteractive(),e.on("pointerdown",()=>{this.flippedCards.length<2&&this.flipTween(e,!1,()=>{this.previewGoing||2!==this.flippedCards.length||this.checkMatch()})}))}createGrid(e){const t=this.cameras.main.centerX,s=this.cameras.main.centerY,i=e.tilesRow*e.tilesColumn/2,a=this.textures.get("cards").getFrameNames();a.shift(),a.shift();const o=[];for(let e=0;e<i;e++){const e=Phaser.Math.RND.pick(a);o.push(e),o.push(e)}this.emptyGroup=this.add.group(),this.group=this.add.group(),Phaser.Utils.Array.Shuffle(o);for(let e=0;e<this.splitter.rows*this.splitter.columns;e++){const e=this.add.sprite(0,0,"cards",0).setScale(this.baseScale);this.emptyGroup.add(e)}for(let t=0;t<e.tilesRow*e.tilesColumn;t++){const e=this.add.sprite(0,0,"cards",0).setScale(this.baseScale);this.group.add(e)}Phaser.Utils.Array.Shuffle(this.group.getChildren());for(let e=0;e<this.group.getChildren().length&&!(e>=o.length);e++)this.group.getChildren()[e].setFrame(1),this.group.getChildren()[e].behindFrame=o[e],this.group.getChildren()[e].pending=!0;Phaser.Actions.GridAlign(this.emptyGroup.getChildren(),{width:this.splitter.columns,height:this.splitter.rows,cellWidth:this.cellSizeX,cellHeight:this.cellSizeY,position:Phaser.Display.Align.CENTER,x:t-this.splitter.columns*this.cellSizeX/2,y:s-this.splitter.rows*this.cellSizeY/2});let n=0,r=0;(this.splitter.columns%2==0&&e.tilesColumn%2!=0||this.splitter.columns%2!=0&&e.tilesColumn%2==0)&&(n=this.cellSizeX/2),(this.splitter.rows%2==0&&e.tilesRow%2!=0||this.splitter.rows%2!=0&&e.tilesRow%2==0)&&(r=this.cellSizeY/2),Phaser.Actions.GridAlign(this.group.getChildren(),{width:e.tilesColumn,height:e.tilesRow,cellWidth:this.cellSizeX,cellHeight:this.cellSizeY,position:Phaser.Display.Align.CENTER,x:t-e.tilesColumn*this.cellSizeX/2-n,y:s-e.tilesRow*this.cellSizeY/2-r}),this.withPreview?(this.previewGoing=!0,this.group.getChildren().forEach(e=>{e&&this.flipTween(e,!1,()=>{setTimeout(()=>{this.flipTween(e,!0,()=>{e&&(this.makeCardInteractive(e),this.previewGoing=!1)},!1)},1e3)},!1)})):this.group.getChildren().forEach(e=>{e&&this.makeCardInteractive(e)})}createNextGame(){if("end"===this.state)return;this.levelDificulty++,this.group.clear(!0,!0),this.emptyGroup.clear(!0,!0),this.configDificulty[this.levelDificulty-1]||(this.levelDificulty=this.configDificulty.length);const e=this.configDificulty[this.levelDificulty-1];this.createGrid({tilesRow:e[0],tilesColumn:e[1]}),this.timer.remove(),this.startTimer()}endGame(){if(this.previewGoing=!1,this.state="end",this.scoreValue>=this.targetScore)this.winnerScreen.show(n.prompt.win,"winner_screen");else if(this.scoreValue>=6501&&this.scoreValue<=9999){const e=this.scoreValue;this.retryScreen.setFinalScore(e),this.retryScreen.show(n.prompt.narrowly,"prompt_screen")}else if(this.scoreValue<6501){const e=this.scoreValue;this.retryScreen.setFinalScore(e),this.retryScreen.show(n.prompt.retry,"prompt_screen")}}removeInteractivityCards(){this.group.getChildren().forEach(e=>{e.disableInteractive()})}resetValues(){this.scoreValue=0,this.levelDificulty=1}adjustDepth(e,t,s=10,i=10){e.setDepth(s),t.setDepth(i)}startTimer(){const e=this.limitTime+2*this.levelDificulty*1e3;let t=Number(e);t>this.maxTime&&(t=this.maxTime);let s=100;this.timer=this.time.addEvent({delay:1,callback:()=>{t--,s=t/e,this.progressBar&&this.progressBar.setCrop(0,0,this.progressBar.width*s,this.progressBar.height),t<=0&&(this.timer.remove(),this.endGame())},loop:!0})}setSoundBtn(){const e=this.add.image(35,55,this.game.sound.mute?"sound_off":"sound_on").setScale(.5);e.setOrigin(.5,.5),e.setInteractive(),e.on("pointerdown",()=>{const t=!this.game.sound.mute;this.game.sound.mute=t,this.game.soundManager.setMute(t),e.setTexture(t?"sound_off":"sound_on")},this)}create(){this.resetGameState(),this.previewGoing=!1,this.winnerScreen=new o.WinnerScreen(this),this.retryScreen=new o.RetryScreen(this),this.closeButton=new r.CloseButton(this),this.eventObserver=c.EventObserver.getInstance(),a.default.LogSceneMethodEntry("MainGame","create");const e=this.add.image(this.cameras.main.centerX,0,"background_secondary");e.setOrigin(.5,0),e.setScale(this.cameras.main.width/e.width);let t=this.cameras.main.height/e.height;this.cameras.main.width/e.width>t&&(t=this.cameras.main.width/e.width),e.setScale(t),this.closeButton.create(),this.score=this.add.image(this.cameras.main.centerX-23,60,"score").setScale(1.09,1.05).setOrigin(.5,.5),this.scoreText=this.add.text(this.cameras.main.centerX+100+20,55,this.scoreValue.toString(),{font:"40px montserrat-memo",color:"#E2D64B"}),this.scoreText.setOrigin(1,.5),this.add.image(this.cameras.main.centerX,2*this.cameras.main.centerY-60,"progress_frame").setOrigin(.5,.5).setScale(1.12);const s=this.add.image(this.cameras.main.centerX,2*this.cameras.main.centerY-60,"progress_bar");s.setOrigin(.5,.5).setScale(1.12),this.progressBar=s,this.startTimer(),this.splitter.rows=6,this.splitter.columns=5;const i=this.configDificulty[this.levelDificulty-1];this.createGrid({tilesRow:i[0],tilesColumn:i[1]});const n=this.add.image(2*this.cameras.main.centerX,2*this.cameras.main.centerY,"powerBySvg");n.setInteractive(),n.on("pointerdown",()=>{window&&window.open("https://minimalart.co/","_blank")}),n.setOrigin(1,1),this.state="start",this.registry.set("score",this.score),this.registry.set("scoreText",this.scoreText),this.eventObserver.on("button-clicked",e=>{l.ButtonEventHandler.handleButtonEvents(e,this)},this)}}t.default=h,h.Name="MainGame"},53:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventObserver=void 0;class s{constructor(){this.eventEmitter=new Phaser.Events.EventEmitter}static getInstance(){return s.instance||(s.instance=new s),s.instance}on(e,t,s){this.eventEmitter.on(e,t,s)}emit(e,...t){this.eventEmitter.emit(e,...t)}}t.EventObserver=s},62:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(422)),o=i(s(924));class n extends Phaser.Scene{preload(){}create(){o.default.LogSceneMethodEntry("Boot","create"),this.scene.start(a.default.Name)}}t.default=n,n.Name="Boot"},105:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),o=i(s(724));class n extends Phaser.Scene{preload(){var e;this.load.path=null!==(e=window.assetFolder)&&void 0!==e?e:"assets/"}create(){a.default.LogSceneMethodEntry("SplashScreen","create"),this.setBackground();const e=this.add.image(2*this.cameras.main.centerX,2*this.cameras.main.centerY,"powerBySvg");e.setOrigin(1,1),e.setInteractive(),e.on("pointerdown",()=>{window&&window.open("https://minimalart.co/","_blank")}),this.time.addEvent({delay:1e3,callback:this.loadMainMenu,callbackScope:this,loop:!1})}setBackground(){const e=this.add.image(this.cameras.main.centerX,0,"background");e.setOrigin(.5,0),e.setScale(this.cameras.main.width/e.width);let t=this.cameras.main.height/e.height;this.cameras.main.width/e.width>t&&(t=this.cameras.main.width/e.width),e.setScale(t)}loadMainMenu(){this.scene.start(o.default.Name)}}t.default=n,n.Name="SplashScreen"},179:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Score=void 0,t.Score=class{constructor(e){this.scene=e,this.score=this.scene.add.image(this.scene.cameras.main.centerX-30,60,"score"),this.score.setOrigin(.5,.5)}}},295:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RetryScreen=void 0;const i=s(618),a=s(891);t.RetryScreen=class{constructor(e){this.scene=e,this.prompt=new a.PromptScreen(e)}addMask(){this.prompt.addMask()}show(e,t){this.prompt.setBackground(t,0,0,1.2,1.2),this.prompt.setTitle(e.title,0,-133,1.2,1.2),this.prompt.setMessage(e.message,0,-30,1.2,1.2),this.prompt.setActions(e.actions,0,60,65,1.2,1.2),this.scene.sound.add("retry").play(),i.Footer.create(this.scene)}setFinalScore(e){this.prompt.setSplashBackground(),this.finalScore=this.scene.add.image(this.scene.cameras.main.centerX,60,"final_score").setScale(1.1,1.1).setDepth(110).setOrigin(.5,.5),this.finalScoreText=this.scene.add.text(this.scene.cameras.main.centerX+135+20,55,e,{font:"40px montserrat-memo",color:"#E2D64B"}).setDepth(110).setOrigin(1,.5)}hide(){this.prompt.hide()}}},317:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PromptScreen=t.RetryScreen=t.WinnerScreen=void 0;var i=s(458);Object.defineProperty(t,"WinnerScreen",{enumerable:!0,get:function(){return i.WinnerScreen}});var a=s(295);Object.defineProperty(t,"RetryScreen",{enumerable:!0,get:function(){return a.RetryScreen}});var o=s(891);Object.defineProperty(t,"PromptScreen",{enumerable:!0,get:function(){return o.PromptScreen}})},319:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(24)),o=s(317),n=s(927),r=s(852),c=s(723),l=s(701),h=s(618),d=s(734),u=s(390),m=[{level:1,goal:600,time:30},{level:2,goal:1300,time:35},{level:3,goal:2500,time:36},{level:4,goal:3800,time:41},{level:5,goal:5200,time:46},{level:6,goal:6700,time:47},{level:7,goal:8100,time:48},{level:8,goal:1e4,time:49}];class g extends a.default.Scene{constructor(){super(...arguments),this.grid=[],this.offsetX=0,this.offsetY=0,this.selectedCandy=null,this.lastMovedCandy=null,this.movingCandiesInProcess=!1,this.scoreValue=0,this.scoreGoal=m[0].goal,this.levelStartScore=0,this.currentLevelIndex=0,this.totalTime=m[0].time,this.matchValue=20,this.comboCount=1,this.comboThreshold=1500,this.gameState="playing",this.handleGlobalMouseUp=e=>{if(!this.selectedCandy)return;const t=this.game.canvas.getBoundingClientRect(),s=e.clientX-t.left,i=e.clientY-t.top,a=s-this.selectedCandy.getData("startX"),o=i-this.selectedCandy.getData("startY");Math.abs(a)>Math.abs(o)?a>15?this.trySwap("right"):a<-15&&this.trySwap("left"):o>15?this.trySwap("down"):o<-15&&this.trySwap("up"),this.selectedCandy.setScale(.6),this.selectedCandy=null}}preload(){this.load.image("progress-frame","assets/progress_bar_frame.png")}getCandyPosition(e,t){return{x:this.offsetX+75.6*t+34.8,y:this.offsetY+75.6*e+34.8}}async createGrid(){this.offsetX=(this.scale.width-372)/2;const e=6*69.6+30;this.offsetY=(this.scale.height-e)/2;for(let e=0;e<6;e++){this.grid[e]=[];for(let t=0;t<5;t++){const s=a.default.Math.Between(1,4),i=this.offsetX+75.6*t+34.8,o=this.offsetY+75.6*e+34.8,n=this.createCandy(i,o,s,e,t);this.grid[e][t]=n}}const t=this.getMatches();t.length>0&&(console.log("MATCH FOUND:",t.length,"caramelos"),await this.processMatches()),this.comboText.setY(this.offsetY-50)}createCandy(e,t,s,i,a){const o=this.add.sprite(e,t,"candies",s).setScale(.6);return o.setData("type",s),o.setData("row",i),o.setData("col",a),o.setInteractive(),o.on("pointerdown",e=>{this.movingCandiesInProcess||"playing"!==this.gameState||(this.selectedCandy=o,o.setScale(.7),o.setData("startX",e.x),o.setData("startY",e.y))}),o}trySwap(e){if(!this.selectedCandy||this.movingCandiesInProcess)return;console.log("triyng swap");let t=this.selectedCandy.getData("row"),s=this.selectedCandy.getData("col");switch(e){case"up":t--;break;case"down":t++;break;case"left":s--;break;case"right":s++}if(t<0||t>=6||s<0||s>=5)return console.log("fuera de limites"),void this.selectedCandy.setScale(.6);const i=this.grid[t][s];if(!i)return console.log("es adjacente"),void this.selectedCandy.setScale(.6);this.swapCandies(this.selectedCandy,i)}swapCandies(e,t){this.movingCandiesInProcess=!0;const s=e.getData("row"),i=e.getData("col"),a=t.getData("row"),o=t.getData("col");this.tweens.add({targets:e,x:t.x,y:t.y,duration:200}),this.tweens.add({targets:t,x:e.x,y:e.y,duration:200}),this.swapCandySound.play(),this.grid[s][i]=t,this.grid[a][o]=e,e.setData("row",a).setData("col",o),t.setData("row",s).setData("col",i),this.lastMovedCandy=e,this.time.delayedCall(250,async()=>{const n=this.getMatches();n.length>0?(this.removeMatches(n),this.dropCandies(),await this.delay(300),await this.refillGrid(),await this.processMatches()):(this.tweens.add({targets:e,x:t.x,y:t.y,duration:200}),this.tweens.add({targets:t,x:e.x,y:e.y,duration:200}),this.grid[s][i]=e,this.grid[a][o]=t,e.setData("row",s).setData("col",i),t.setData("row",a).setData("col",o)),this.movingCandiesInProcess=!1})}getMatches(){const e=new Set;for(let t=0;t<6;t++){let s=[];for(let i=0;i<5;i++){const a=this.grid[t][i],o=i>0?this.grid[t][i-1]:null;a&&o&&a.getData("type")===o.getData("type")?(s.push(a),1===s.length&&s.unshift(o)):(s.length>=3&&s.forEach(t=>e.add(t)),s=[])}s.length>=3&&s.forEach(t=>e.add(t))}for(let t=0;t<5;t++){let s=[];for(let i=0;i<6;i++){const a=this.grid[i][t],o=i>0?this.grid[i-1][t]:null;a&&o&&a.getData("type")===o.getData("type")?(s.push(a),1===s.length&&s.unshift(o)):(s.length>=3&&s.forEach(t=>e.add(t)),s=[])}s.length>=3&&s.forEach(t=>e.add(t))}return Array.from(e)}updateScore(e){var t;this.scoreValue+=e,this.scoreText.setText(this.scoreValue.toString());const s=this.scoreValue-this.levelStartScore,i=this.scoreGoal-this.levelStartScore,o=a.default.Math.Clamp(s/i,0,1),n=this.logoColor.width*o;this.logoColor.setCrop(0,0,n,this.logoColor.height),this.scoreValue>=this.scoreGoal&&"ended"!==this.gameState&&(null===(t=this.progressTimer)||void 0===t||t.remove(!1),this.currentLevelIndex===m.length-1?this.endGame():this.nextLevel())}updateProgressBar(e){const t=this.cameras.main.centerX-160,s=this.scale.height-86;this.progressBar.clear(),this.progressBar.fillStyle(4048159,1),this.progressBar.fillRoundedRect(t,s,320*e,29,5)}nextLevel(){var e;if(this.currentLevelIndex++,null===(e=this.clockTickingSound)||void 0===e||e.stop(),this.currentLevelIndex>=m.length)return void this.endGame();const t=m[this.currentLevelIndex];this.scoreGoal=t.goal,this.totalTime=t.time,this.levelStartScore=this.scoreValue,this.gameState="paused",this.showLevelUpScreen(t.level,t.goal)}showLevelUpScreen(e,t){this.levelUpSound.play(),this.updateProgressBar(1),this.logoColor.setCrop(0,0,0,this.logoColor.height),this.levelUpScreen.once("closed",()=>{this.startNextLevel()}),this.levelUpScreen.show(e,t)}async startNextLevel(){var e;await this.refillGrid(),null===(e=this.progressTimer)||void 0===e||e.destroy(),this.progressTimer=this.time.addEvent({delay:1e3*this.totalTime,callback:()=>this.endGame()}),this.gameState="playing"}endGame(){var e,t,s,i,a,o,r,c,l;"ended"!==this.gameState&&(this.gameState="ended",this.movingCandiesInProcess=!1,null===(t=null===(e=this.logoWhite)||void 0===e?void 0:e.destroy)||void 0===t||t.call(e),null===(i=null===(s=this.logoColor)||void 0===s?void 0:s.destroy)||void 0===i||i.call(s),null===(o=null===(a=this.closeButton)||void 0===a?void 0:a.destroy)||void 0===o||o.call(a),null===(r=this.progressTimer)||void 0===r||r.remove(!1),null===(c=this.clockTickingSound)||void 0===c||c.stop(),null===(l=this.bgMusic)||void 0===l||l.stop(),this.scoreValue>=this.scoreGoal?(this.winnerScreen.show(n.prompt.win,"winner_screen"),console.log("WIN")):(console.log("ELSE"),this.retryScreen.setFinalScore(this.scoreValue),this.retryScreen.show(n.prompt.retry,"prompt_screen")))}removeMatches(e){console.log("removematches");const t=10*e.length*this.comboCount;this.updateScore(t),this.comboCount>1&&"playing"===this.gameState&&(this.comboSound.play(),this.showComboText(`x${this.comboCount}`)),this.comboCount++,this.comboTimer&&this.comboTimer.remove(),this.comboTimer=this.time.delayedCall(this.comboThreshold,()=>{this.comboCount=1}),e.length>=5&&(this.cameras.main.shake(220,.006),this.cameras.main.flash(50,100,100,255),this.lastMovedCandy&&(this.showComboX5Bonus(this.lastMovedCandy.x,this.lastMovedCandy.y),this.updateScore(50))),e.forEach(e=>{const t=e.getData("row"),s=e.getData("col");this.grid[t][s]=null,this.tweens.add({targets:e,scale:0,duration:200,ease:"Back.easeIn",onComplete:()=>{e.destroy()}})}),this.lastMovedCandy=null}SparkleEffect(e,t){const s=this.add.particles(e,t,"sparkle",{speed:{min:60,max:120},angle:{min:0,max:360},scale:{start:.4,end:0},alpha:{start:1,end:.2},lifespan:250,quantity:5,gravityY:0,blendMode:"LIGHTEN",emitZone:{type:"random",source:new a.default.Geom.Circle(0,0,20)}});s.setDepth(0),this.time.delayedCall(300,()=>{s.destroy()})}showComboX5Bonus(e,t){this.comboX5Sound.play();const s=this.add.image(e,t,"combo_x5_mogul").setScale(.5).setDepth(20).setAlpha(.9);this.tweens.add({targets:s,y:t-45,x:this.scale.width/2-18,alpha:0,duration:1900,ease:"Cubic.easeOut",onComplete:()=>s.destroy()})}showComboText(e){this.comboText.setText(e),this.comboText.setAlpha(1),this.comboText.setScale(1),this.comboText.setY(this.scale.height/2-50),this.tweens.add({targets:this.comboText,y:this.scale.height/2-80,alpha:0,duration:800,ease:"Cubic.easeOut"})}dropCandies(){if(console.log("droppcandies"),"playing"===this.gameState)for(let e=0;e<5;e++)for(let t=5;t>=0;t--)if(null===this.grid[t][e])for(let s=t-1;s>=0;s--){const i=this.grid[s][e];if(i){const{x:a,y:o}=this.getCandyPosition(t,e);this.tweens.add({targets:i,y:o,duration:200}),this.grid[t][e]=i,i.setData("row",t),this.grid[s][e]=null;break}}}refillGrid(){return console.log("reffill"),this.movingCandiesInProcess=!0,new Promise(e=>{if("playing"!==this.gameState&&"paused"!==this.gameState)return e();for(let e=0;e<6;e++)for(let t=0;t<5;t++)if(!this.grid[e][t]){const s=a.default.Math.Between(1,4),{x:i,y:o}=this.getCandyPosition(e,t),n=o-151.2,r=this.createCandy(i,o,s,e,t);r.y=n,this.tweens.add({targets:r,y:o,duration:300}),this.grid[e][t]=r}this.time.delayedCall(350,async()=>{const t=this.getMatches();t.length>0?(this.removeMatches(t),this.time.delayedCall(300,()=>{this.dropCandies(),this.time.delayedCall(300,async()=>{await this.refillGrid(),e()})})):this.hasPossibleMoves()?(this.movingCandiesInProcess=!1,e()):(this.showShuffleMessage(),this.shuffleCandySound.play(),this.shuffleBoard(),this.time.delayedCall(200,async()=>{await this.refillGrid(),e()}))})})}swapData(e,t){const s=e.getData("row"),i=e.getData("col"),a=t.getData("row"),o=t.getData("col");this.grid[s][i]=t,this.grid[a][o]=e,e.setData("row",a),e.setData("col",o),t.setData("row",s),t.setData("col",i)}hasPossibleMoves(){for(let e=0;e<6;e++)for(let t=0;t<5;t++){const s=this.grid[e][t];if(!s)continue;const i=s.getData("type");if(t<4){const a=this.grid[e][t+1];if(!a)continue;if(a.getData("type")!==i){this.swapData(s,a);const e=this.getMatches();if(this.swapData(s,a),e.length>0)return!0}}if(e<5){const a=this.grid[e+1][t];if(!a)continue;if(a.getData("type")!==i){this.swapData(s,a);const e=this.getMatches();if(this.swapData(s,a),e.length>0)return!0}}}return!1}shuffleBoard(){let e=0;const t=[];for(let e=0;e<6;e++)for(let s=0;s<5;s++){const i=this.grid[e][s];i&&t.push(i)}if(30!==t.length)return console.warn("⚠️ Grilla incompleta antes de barajar. Se completará."),void this.refillGrid();let s=!1;do{a.default.Utils.Array.Shuffle(t);let i=0;for(let e=0;e<6;e++)for(let s=0;s<5;s++){const a=t[i++],{x:o,y:n}=this.getCandyPosition(e,s);a.setPosition(o,n),a.setData("row",e),a.setData("col",s),this.grid[e][s]=a}s=this.hasPossibleMoves(),e++}while(!s&&e<20);s||(console.warn("🔁 No se pudieron generar jugadas después de múltiples intentos."),this.showShuffleMessage())}showShuffleMessage(){const e=this.scale.width,t=this.scale.height,s=this.add.rectangle(e/2,t/2,.9*e,60,9024,.95).setOrigin(.5).setDepth(10),i=this.add.text(e/2,t/2,"No hay jugadas disponibles",{fontSize:"20px",color:"#ffffff",fontFamily:"montserrat-memo"}).setOrigin(.5).setDepth(11);this.time.delayedCall(700,()=>{s.destroy(),i.destroy()})}delay(e){return new Promise(t=>this.time.delayedCall(e,t))}async processMatches(){if("playing"!==this.gameState)return;this.movingCandiesInProcess=!0;const e=this.getMatches();e.length>0?(this.removeMatches(e),this.dropCandies(),await this.delay(300),await this.refillGrid()):this.movingCandiesInProcess=!1}async playIntroAnimation(){return new Promise(e=>{const t=this.add.image(10,16,"score").setOrigin(0,0),s=t.width,i=t.height;this.scoreText=this.add.text(20+s-30,17+i/2,"0",{fontFamily:"montserrat-memo",fontSize:"40px",color:"#FEC647",fontStyle:"bold"}).setOrigin(1,.5),this.soundButton=this.add.image(this.scale.width-15,68,"sound_on").setOrigin(1,0).setScale(1).setInteractive({useHandCursor:!0}),this.soundButton.on("pointerdown",()=>{const e=this.bgMusic.toggleMute();this.soundButton.setTexture(e?"sound_off":"sound_on")}),this.closeButton.create(),this.eventObserver.on("button-clicked",e=>{r.ButtonEventHandler.handleButtonEvents(e,this)},this),h.Footer.create(this),this.startLevelSound.play(),this.showIntroText(),this.time.delayedCall(1600,()=>{this.spawnFallingCandies(35),this.powerDowmSound.play(),this.electricSparksSound.play();const t=this.add.particles(0,0,"ray_effect",{x:{min:6,max:16+this.logoColor.displayWidth+10},y:{min:15,max:25+this.logoColor.displayHeight+10},lifespan:600,speed:0,quantity:1,scale:{start:.15,end:0},angle:{min:0,max:360},alpha:{start:.3,end:0},rotate:{min:0,max:360},gravityY:0,blendMode:"ADD"});t.setDepth(0),this.time.delayedCall(2e3,()=>{t.stop()}),this.tweens.addCounter({from:1,to:0,duration:2700,onUpdate:e=>{const t=e.getValue(),s=this.logoColor.width*t;this.logoColor.setCrop(0,0,s,this.logoColor.height)},onComplete:()=>e()})})})}showIntroText(){const e=this.cameras.main.centerX,t=this.scale.height/2,s=16+this.logoColor.displayWidth/2,i=25+this.logoColor.displayHeight/2;this.recargaMasti=this.add.image(e,t,"recarga_masti").setScale(.4).setAlpha(0).setDepth(999),this.tweens.add({targets:this.recargaMasti,scale:{from:.6,to:.4},alpha:1,duration:500,ease:"Back.Out",onComplete:()=>{this.time.delayedCall(700,()=>{this.tweens.add({targets:this.recargaMasti,x:s,y:i,scale:.15,alpha:0,duration:1800,ease:"Cubic.easeInOut",onComplete:()=>this.recargaMasti.destroy()})})}})}spawnFallingCandies(e){for(let t=0;t<e;t++){const e=a.default.Math.Between(0,8),t=a.default.Math.Between(0,this.scale.width+50),s=a.default.Math.Between(-200,-40),i=this.add.sprite(t,s,"candies_logo",e).setAlpha(.25).setScale(a.default.Math.FloatBetween(.5,.6)).setDepth(1).setAngle(a.default.Math.Between(-30,30));this.tweens.add({targets:i,y:this.scale.height+60,delay:a.default.Math.Between(600,1900),duration:2300,ease:"Linear",onComplete:()=>i.destroy()})}}async createGridWithoutMatches(){var e,t,s,i,o,n;this.offsetX=(this.scale.width-372)/2;const r=6*69.6+30;this.offsetY=(this.scale.height-r)/2;for(let r=5;r>=0;r--){this.grid[r]=[];for(let c=0;c<5;c++){let l;do{l=a.default.Math.Between(1,4)}while(c>=2&&(null===(e=this.grid[r][c-1])||void 0===e?void 0:e.getData("type"))===l&&(null===(t=this.grid[r][c-2])||void 0===t?void 0:t.getData("type"))===l||r<=3&&(null===(i=null===(s=this.grid[r+1])||void 0===s?void 0:s[c])||void 0===i?void 0:i.getData("type"))===l&&(null===(n=null===(o=this.grid[r+2])||void 0===o?void 0:o[c])||void 0===n?void 0:n.getData("type"))===l);const{x:h,y:d}=this.getCandyPosition(r,c),u=this.createCandy(h,d,l,r,c);u.setAlpha(0),this.grid[r][c]=u,this.tweens.add({targets:u,alpha:1,duration:300,delay:40*(6-r+c)})}}return this.delay(900)}init(e){var t,s;this.currentLevelIndex=null!==(t=e.levelIndex)&&void 0!==t?t:0,this.scoreValue=null!==(s=e.score)&&void 0!==s?s:0;const i=m[this.currentLevelIndex];this.scoreGoal=i.goal,this.totalTime=i.time,this.levelStartScore=this.scoreValue}async create(){this.gameState="playing",this.closeButton=new l.CloseButton(this),this.retryScreen=new o.RetryScreen(this),this.winnerScreen=new o.WinnerScreen(this),this.eventObserver=c.EventObserver.getInstance(),this.levelUpScreen=new d.LevelUpScreen(this),this.bgMusic=new u.BackgroundMusic(this,"candy_music_background_sound",.23),this.levelUpSound=this.sound.add("level_up",{volume:.6,loop:!1}),this.swapCandySound=this.sound.add("swap_candy"),this.matchSound=this.sound.add("match_sound"),this.shuffleCandySound=this.sound.add("shuffle_candies"),this.logoWhite=this.add.image(16,25,"logo_mogul_white").setScale(.23).setOrigin(0,0).setDepth(1),this.logoColor=this.add.image(16,25,"logo_mogul_color").setScale(.23).setOrigin(0,0).setDepth(2).setCrop(0,0,0,60),this.powerDowmSound=this.sound.add("power_down_sound"),this.electricSparksSound=this.sound.add("electric_sparks_sound"),this.comboSound=this.sound.add("combo_sound"),this.comboX5Sound=this.sound.add("combo_x5_sound"),this.clockTickingSound=this.sound.add("clock_ticking_sound",{loop:!1}),this.earthRocksSound=this.sound.add("earth_rocks_sound"),this.startLevelSound=this.sound.add("start_level_sound"),this.comboText=this.add.text(this.cameras.main.centerX,this.scale.height/2,"",{font:"48px montserrat-memo",color:"#FFD700",fontStyle:"bold"}).setOrigin(.5).setAlpha(0).setDepth(999),document.addEventListener("mouseup",this.handleGlobalMouseUp),await this.playIntroAnimation(),await this.delay(400),await this.createGridWithoutMatches(),this.bgMusic.play(),this.progressFrame=this.add.image(this.cameras.main.centerX,this.scale.height-68,"progress-frame").setOrigin(.5),this.progressBar=this.add.graphics(),this.updateProgressBar(1),this.progressTimer=this.time.addEvent({delay:1e3*this.totalTime,callback:()=>{this.endGame()}}),this.events.on("update",()=>{const e=this.progressTimer.getElapsed(),t=Math.ceil((this.progressTimer.delay-e)/1e3),s=a.default.Math.Clamp(1-e/this.progressTimer.delay,0,1);this.updateProgressBar(s),10!==t||this.clockTickingSound.isPlaying||this.clockTickingSound.play()}),this.input.on("pointerup",e=>{if(!this.selectedCandy)return;const t=e.x-this.selectedCandy.getData("startX"),s=e.y-this.selectedCandy.getData("startY");Math.abs(t)>Math.abs(s)?t>15?this.trySwap("right"):t<-15&&this.trySwap("left"):s>15?this.trySwap("down"):s<-15&&this.trySwap("up"),this.selectedCandy.setScale(.6),this.selectedCandy=null})}getScoreValue(){return this.scoreValue.toString()}}t.default=g,g.Name="MainGame"},390:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundMusic=void 0,t.BackgroundMusic=class{constructor(e,t,s=.2){this.muted=!1,this.scene=e,this.key=t,this.music=this.scene.sound.add(this.key,{loop:!0,volume:s})}play(){this.music.play()}stop(){this.music&&this.music.isPlaying&&this.music.stop()}pause(){this.music&&this.music.isPlaying&&this.music.pause()}resume(){this.music&&this.music.isPaused&&this.music.resume()}setVolume(e){this.music.setVolume(e)}mute(){this.music.setMute(!0),this.muted=!0}unmute(){this.music.setMute(!1),this.muted=!1}toggleMute(){return this.muted=!this.muted,this.music.setMute(this.muted),this.muted}isMuted(){return this.muted}}},422:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(105)),o=i(s(924));class n extends Phaser.Scene{preload(){var e;this.load.path=null!==(e=window.assetFolder)&&void 0!==e?e:"assets/",this.load.spritesheet("diamonds","diamonds32x24x5.png",{frameWidth:32,frameHeight:24}),this.load.spritesheet("cards","spritesheet_cards_2x_new.png",{frameWidth:116,frameHeight:116}),this.load.spritesheet("candies","spritesheet_cards_candy.png",{frameWidth:116,frameHeight:116}),this.load.spritesheet("candies_logo","spritesheet_cards_candy_logo.png",{frameWidth:116,frameHeight:116}),this.load.spritesheet("spritesheet_thunder_explo","spritesheet_thunder_explo.png",{frameWidth:116,frameHeight:116}),this.load.spritesheet("spritesheet_confetti","spritesheet_confetti.png",{frameWidth:50,frameHeight:50}),this.load.image("progress_frame","progress_bar_frame.png"),this.load.image("progress_bar","progress_bar_full.png"),this.load.svg("powerBySvg","powerBy_w.svg",{width:400,height:30,scale:1}),this.load.svg("tevas_title","tevas_title.svg"),this.load.svg("retry_button","retry_button.svg"),this.load.image("logo_mogul_color","logo_mogul_color.png"),this.load.image("logo_mogul_white","logo_mogul_white.png"),this.load.image("sparkle","sparkle_img.png"),this.load.image("candy_glow","candy_glow_img.png"),this.load.image("recarga_masti","recarga_masti.png"),this.load.image("phaser_pixel_medium_flat"),this.load.image("background","background.png"),this.load.image("background_main","background_main.png"),this.load.image("prompt_bg","background_main.png"),this.load.image("combo_x5_mogul","combo_x5_mogul.png"),this.load.image("sound_off","sound_off.png"),this.load.image("sound_on","sound_on.png"),this.load.image("score","frame-score.png"),this.load.image("ray_effect","ray_effect.png"),this.load.image("final_score","final_score.png"),this.load.image("prompt_screen","prompt_screen.png"),this.load.image("retry_message","cada-vez-mas-cerca.png"),this.load.image("close_button","close.png"),this.load.image("seguiintentando_title","segui-intentando.png"),this.load.image("porpoco_title","porpoco_title.png"),this.load.image("exit_arcor_button","ir_a_tienda.png"),this.load.image("winner_screen","win_screen.png"),this.load.image("win_title","win_title.png"),this.load.image("win_message","win_message.png"),this.load.image("background_secondary","background_secondary.png"),this.load.image("tevas_message","tevas_message.png"),this.load.image("tevas_button","tevas_button.png"),this.load.image("copy_coupon_button","copy_coupon_button.png"),this.load.image("copied_coupon_button","copied_button.png"),this.load.image("coupon_code_container","coupon_code_container.png"),this.load.image("logo_candy_Arcor","logo-candy-arcor.png"),this.load.image("logo_candy_Arcor_win","logo_candy_Arcor_win.png"),this.load.image("logo_Arcor","logo-arcor-en-casa.png"),this.load.image("logo","logo-home.png"),this.load.image("play","play.png"),this.load.image("reset","reset_2x.png"),this.load.image("Phaser-Logo-Small"),this.load.audio("music","music.mp3"),this.load.audio("coinsplash","coinsplash.mp3"),this.load.audio("collectcoin","collectcoin.mp3"),this.load.audio("tadaa","tadaa.mp3"),this.load.audio("retry","retry.mp3"),this.load.audio("cash","cash-register.mp3"),this.load.audio("cardFlip","cardFlip.wav"),this.load.audio("level_up","level-up.mp3"),this.load.audio("swap_candy","swap-candy.mp3"),this.load.audio("match_sound","match_sound.mp3"),this.load.audio("shuffle_candies","shuffle_candies.mp3"),this.load.audio("combo_sound","combo_sound.mp3"),this.load.audio("combo_x5_sound","combo_x5_sound.mp3"),this.load.audio("power_down_sound","power_down_sound.mp3"),this.load.audio("electric_sparks_sound","electric_sparks_sound.mp3"),this.load.audio("clock_ticking_sound","clock_ticking_sound.mp3"),this.load.audio("earth_rocks_sound","earth_rocks_sound.mp3"),this.load.audio("start_level_sound","start_level_sound.mp3"),this.load.audio("candy_music_background_sound","candy_music_background_sound.mp3")}init(){this.addProgressBar()}create(){o.default.LogSceneMethodEntry("Preloader","create"),this.scene.start(a.default.Name);const e=this.add.image(this.cameras.main.centerX,0,"background");e.setOrigin(.5,0),e.setScale(this.cameras.main.width/e.width);let t=this.cameras.main.height/e.height;this.cameras.main.width/e.width>t&&(t=this.cameras.main.width/e.width),e.setScale(t);const s=this.add.image(this.cameras.main.centerX,2*this.cameras.main.centerY,"powerBy");s.setInteractive(),s.on("pointerdown",()=>{window&&window.open("https://minimalart.co/","_blank")}),s.setOrigin(.5,1).setScale(1.15/3)}update(){}addProgressBar(){const e=this.cameras.main.width,t=this.cameras.main.height,s=this.add.graphics(),i=this.add.graphics();i.fillStyle(40879,.8),i.fillRect(e/4,t/2-30,e/2,50),i.setDepth(110),s.setDepth(110);const a=this.make.text({x:e/2,y:t/2-50,text:"Cargando",style:{font:"20px montserrat-memo",color:"#E2D64B"}});a.setOrigin(.5,.5),a.setDepth(110);const o=this.make.text({x:e/2,y:t/2-5,text:"0%",style:{font:"18px montserrat-memo",color:"#E2D64B"}});o.setOrigin(.5,.5),o.setDepth(110);const n=this.make.text({x:e/2,y:t/2+50,text:"",style:{font:"18px monospace",color:"#ffffff"}});n.setOrigin(.5,.5),n.setDepth(110),this.load.on("progress",i=>{o.setText(parseInt(100*i+"",10)+"%"),s.clear(),s.fillStyle(8277,1),s.fillRect(e/4+10,t/2-30+10,(e/2-10-10)*i,30)}),this.load.on("complete",()=>{s.destroy(),i.destroy(),a.destroy(),o.destroy(),n.destroy()})}}t.default=n,n.Name="Preloader"},437:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buttons=t.prompt=void 0;const s={retry:{eventName:"retry",background:"retry_button"},exitArcor:{eventName:"exit",background:"exit_arcor_button"},back:{eventName:"back",background:"tevas_button"},copy:{eventName:"copy",background:"copy_coupon_button"},close:{eventName:"close",background:"close_button"},copied:{eventName:"copy",background:"copied_coupon_button"}};t.buttons=s;const i={retry:{title:"seguiintentando_title",message:"retry_message",actions:[s.retry,s.exitArcor],data:{}},narrowly:{title:"porpoco_title",message:"retry_message",actions:[s.retry,s.exitArcor],data:{}},win:{title:"win_title",message:"win_message",actions:[s.copy,s.exitArcor],data:{}},leaving:{title:"tevas_title",message:"tevas_message",actions:[s.back,s.exitArcor],data:{}}};t.prompt=i},458:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WinnerScreen=void 0;const i=s(618),a=s(891),o=s(723),n=s(927);t.WinnerScreen=class{constructor(e){this.prompt=new a.PromptScreen(e),this.scene=e,this.eventObserver=o.EventObserver.getInstance()}show(e,t){this.scene.closeButton.destroy(),this.prompt.setSplashBackground(),this.setSplashLogo(),this.prompt.setBackground(t,0,80,1.1,1.1),this.prompt.setTitle(e.title,0,-90,1.1,1.1),this.setWinnerScore(),this.prompt.setMessage(e.message,0,60,1.1,1.1),this.setWinnerCouponCode(),this.prompt.setActions(e.actions,0,190,60,1.1,1.1),this.scene.sound.add("tadaa").play({volume:.3}),i.Footer.create(this.scene),this.eventObserver.on("button-clicked",e=>{"copy"==e&&this.prompt.setActions([n.buttons.copied],0,190,60,1.1,1.1),setTimeout(()=>{this.prompt.setActions([n.buttons.copy],0,190,60,1.1,1.1)},1500)},this)}setSplashLogo(){const e=this.scene.add.image(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY-235,"logo_candy_Arcor_win").setOrigin(.5,.5).setDepth(10).setScale(0);this.scene.tweens.add({targets:e,scale:.8,delay:0,duration:10,ease:"Bounce.easeOut"})}setWinnerCouponCode(){this.couponCodeContainer=this.scene.add.image(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY+130,"coupon_code_container").setOrigin(.5,.5).setDepth(10).setScale(1.1,1.1),this.couponCode=this.scene.add.text(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY+125,this.scene.game.getCouponCode(),{font:"20px montserrat-memo",color:"#FFFFFF"}).setOrigin(.5,.5).setDepth(10).setScale(1.1,1.1),this.scene.tweens.add({targets:this.couponCode,y:this.couponCode.y-30,scaleY:1.2,duration:200,ease:"Power1",yoyo:!0,onComplete:()=>{this.scene.tweens.add({targets:this.couponCode,y:this.scene.cameras.main.centerY+128,duration:30,ease:"Bounce.easeOut"})}})}setWinnerScore(){this.finalScore=this.scene.add.text(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY-15,this.scene.getScoreValue(),{font:"40px montserrat-memo",color:"#E2D64B"}).setOrigin(.5,.5).setDepth(10).setScale(1.1,1.1)}hide(){this.prompt.hide()}}},509:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.scene=e}setSplashBackground(){const e=this.scene.add.image(this.scene.cameras.main.centerX,0,"background_secondary");e.setOrigin(.5,0),e.setScale(this.scene.cameras.main.width/e.width);let t=this.scene.cameras.main.height/e.height;this.scene.cameras.main.width/e.width>t&&(t=this.scene.cameras.main.width/e.width),e.setScale(t)}addMask(){const e=this.scene.add.graphics();e.fillStyle(0,.5),e.fillRect(0,0,this.scene.cameras.main.width,this.scene.cameras.main.height),e.setDepth(3)}adjustDepth(e,t,s=10,i=10){e.setDepth(s),t.setDepth(i)}}},552:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),s(24);const a=i(s(62)),o=i(s(422)),n=i(s(724)),r=i(s(105)),c=i(s(924)),l=i(s(319)),h=i(s(982)),d=i(s(856)),u={width:400>window.innerWidth?window.innerWidth:400,height:window.innerHeight,type:Phaser.AUTO,transparent:!0,parent:"content",title:"Juego Candy para Arcor"};class m extends Phaser.Game{constructor(e){c.default.LogSceneMethodEntry("Game","constructor"),super(e),this.selectedCoupon="PRIMAVERA-5U5Y5",this.onCloseGame=e.onClose,this.scene.add(a.default.Name,a.default),this.scene.add(o.default.Name,o.default),this.scene.add(r.default.Name,r.default),this.scene.add(n.default.Name,n.default),this.scene.add(l.default.Name,l.default),this.scene.add(d.default.Name,d.default),this.scene.add(h.default.Name,h.default),this.scene.start(a.default.Name),this.selectedCoupon=this.getRandomCoupon()}getRandomCoupon(){const e=["PRIMAVERA-096JB","PRIMAVERA-1YPLD","PRIMAVERA-2HBCV","PRIMAVERA-307TT","PRIMAVERA-4WXTB","PRIMAVERA-5U5Y5","PRIMAVERA-60ASF","PRIMAVERA-7P6DY","PRIMAVERA-8S8FJ4","PRIMAVERA-94X04"];return e[Math.floor(Math.random()*e.length)]}getCouponCode(){return this.selectedCoupon}}function g(e){let t=400;428===window.innerWidth?t=440:414===window.innerWidth?t=414:t>window.innerWidth&&(t=window.innerWidth);const s=window.innerHeight;e&&(e.scale.resize(t,s),e.renderer.resize(t,s),e.scene.scenes.forEach(i=>{if(i.cameras.main&&i.scene.isActive()){i.cameras.main.setViewport(0,0,t,s);const a=window.innerWidth/400;i.cameras.main.setZoom(a),e.scale.refresh(),i.cameras.main.flash(1e3),i.scene.stop(),i.scene.start()}}))}t.default=m,window&&(window.newGame=e=>{const t=Object.assign(Object.assign({},u),e);t.assetFolder&&(window.assetFolder=t.assetFolder);const s=new m(t);window.game=s,g(s),window.addEventListener("resize",()=>g(s),!0)},window.onload=()=>{const e=window.location.search;new URLSearchParams(e).get("async")?console.log("Waiting for instructions"):window.newGame({})})},601:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CloseButton=void 0;const i=s(653),a=s(927);class o{constructor(e){this.scene=e}create(e=0,t=4){this.button=new i.Button(this.scene,this.scene.cameras.main.scrollX+this.scene.cameras.main.width-35+e,this.scene.cameras.main.scrollY+35+t,a.buttons.close,1.05,1.05),this.button.createButton()}destroy(){this.button.destroy()}}t.CloseButton=o,o.Name="CloseButtonScene"},618:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0,t.Footer=class{static create(e){e.add.image(2*e.cameras.main.centerX,2*e.cameras.main.centerY,"powerBySvg").setInteractive().on("pointerdown",()=>{window&&window.open("https://minimalart.co/","_blank")}).setOrigin(1,1).setDepth(110)}}},653:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;const i=s(723);t.Button=class{constructor(e,t,s,a,o=1,n=1){this.scene=e,this.x=t,this.y=s,this.action=a,this.scaleX=o,this.scaleY=n,this.eventObserver=i.EventObserver.getInstance()}createButton(){this.button=this.scene.add.image(this.x,this.y,this.action.background).setInteractive().on("pointerdown",e=>{this.eventObserver.emit("button-clicked",this.action.eventName)}).on("pointerup",()=>{this.releaseButtonEffect()}).on("pointerout",()=>{this.button.setTint(16777215),this.releaseButtonEffect()}).setOrigin(.5,.5).setDepth(100).setScale(this.scaleX,this.scaleY)}pressButtonEffect(){this.scene.tweens.add({targets:this.button,scaleX:.9*this.scaleX,scaleY:.9*this.scaleY,duration:100,ease:"Power1"})}releaseButtonEffect(){this.scene.tweens.add({targets:this.button,scaleX:this.scaleX,scaleY:this.scaleY,duration:300,ease:"Power1"})}destroy(){this.button.destroy()}}},701:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Score=t.CloseButton=t.Button=void 0;var i=s(653);Object.defineProperty(t,"Button",{enumerable:!0,get:function(){return i.Button}});var a=s(601);Object.defineProperty(t,"CloseButton",{enumerable:!0,get:function(){return a.CloseButton}});var o=s(179);Object.defineProperty(t,"Score",{enumerable:!0,get:function(){return o.Score}})},723:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventObserver=void 0;var i=s(53);Object.defineProperty(t,"EventObserver",{enumerable:!0,get:function(){return i.EventObserver}})},724:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),o=i(s(34)),n=s(317),r=s(723),c=s(618);class l extends Phaser.Scene{constructor(){super(...arguments),this.alreadyPlayignMusic=!1}init(){this.retryScreen=new n.RetryScreen(this),this.eventObserver=r.EventObserver.getInstance(),this.game.config.audio.disableWebAudio=!1,this.game.soundManager=Phaser.Sound.SoundManagerCreator.create(this.game),this.music=this.game.soundManager,this.game.sound.mute=!1}preload(){}pauseScene(){this.scene.pause(l.Name)}resumeScene(){this.scene.resume(l.Name)}create(){a.default.LogSceneMethodEntry("MainMenu","create"),this.alreadyPlayignMusic||(this.alreadyPlayignMusic=!0);const e=this.add.image(this.cameras.main.centerX,this.cameras.main.height,"background_main");e.setOrigin(.5,1);let t=this.cameras.main.width/e.width,s=this.cameras.main.height/e.height,i=Math.max(t,s);e.setScale(i);const n=this.add.image(this.cameras.main.centerX,50,"logo_Arcor").setScale(0).setOrigin(.5,0);this.tweens.add({targets:n,scale:1,delay:0,duration:600,ease:"Bounce.easeOut"});const r=this.add.image(this.cameras.main.centerX,.5*this.cameras.main.centerY,"logo_candy_Arcor").setScale(0).setDepth(3);this.tweens.add({targets:r,scale:1.05,delay:0,duration:600,ease:"Bounce.easeOut"}),r.setOrigin(.5,0);const l=this.add.image(this.cameras.main.centerX,r.y+1.05*r.height+10,"candies_logo",0).setOrigin(.5).setScale(0).setDepth(5),h=this.add.image(this.cameras.main.centerX,r.y+1.05*r.height+10+40,"candies_logo",3).setOrigin(.5).setScale(0).setDepth(6),d=this.add.image(this.cameras.main.centerX,r.y+1.05*r.height+10+40,"candies_logo",2).setOrigin(.5).setScale(0).setDepth(5),u=this.add.image(this.cameras.main.centerX,r.y+1.05*r.height+10+40,"candies_logo",7).setOrigin(.5).setScale(0).setDepth(4),m=l.x,g=l.y;this.tweens.add({targets:l,scale:1,x:m-120,y:g-15,angle:-125,delay:600,duration:600,ease:"Bounce.easeOut"}),this.tweens.add({targets:[l],scale:1.1,delay:1300,angle:-130,duration:300,ease:"Power1",yoyo:!0,loop:-1}),this.tweens.add({targets:h,scale:1,x:m-80,y:g-5,angle:15,delay:600,duration:600,ease:"Bounce.easeOut"}),this.tweens.add({targets:[h],scale:1.1,delay:1100,angle:10,duration:300,ease:"Power1",yoyo:!0,loop:-1}),this.tweens.add({targets:d,scale:.95,x:m+80,y:g-5,angle:135,delay:600,duration:600,ease:"Bounce.easeOut"}),this.tweens.add({targets:[d],scale:.9,delay:1080,angle:115,duration:300,ease:"Power1",yoyo:!0,loop:-1}),this.tweens.add({targets:u,scale:1.2,x:m+110,y:g-8,angle:130,delay:600,duration:600,ease:"Bounce.easeOut"}),this.tweens.add({targets:[u],scale:1.3,delay:1300,angle:120,duration:300,ease:"Power1",yoyo:!0,loop:-1});const p=this.add.image(this.cameras.main.centerX,1.3*this.cameras.main.centerY,"play").setScale(0).setDepth(7);this.tweens.add({targets:p,scale:1,delay:200,duration:600,ease:"Bounce.easeOut"}),p.setOrigin(.5,.5),p.setInteractive(),p.on("pointerover",()=>{p.setTint(15658734)},this),p.on("pointerout",()=>{p.setTint(16777215)},this),p.on("pointerdown",()=>{this.scene.start(o.default.Name)},this),c.Footer.create(this)}update(){}}t.default=l,l.Name="MainMenu"},734:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LevelUpScreen=void 0;const a=i(s(24));class o extends a.default.Events.EventEmitter{createConfettiEmitter(){const e=this.scene.scale.width/2,t=this.scene.scale.height/2,s=this.scene.add.particles(0,0,"spritesheet_confetti",{frame:a.default.Utils.Array.NumberArray(0,23),speed:{min:50,max:130},angle:{min:0,max:300},gravityY:60,scale:{start:.25,end:0},lifespan:7e3,rotate:{min:-120,max:120},alpha:{start:1,end:.2},quantity:30,frequency:-1,emitZone:{type:"random",source:new a.default.Geom.Circle(e,t,60)}});this.container.addAt(s,1),s.explode(170),this.scene.time.delayedCall(8e3,()=>{s.destroy()})}constructor(e){super(),this.scene=e;const t=this.scene.cameras.main.centerX,s=this.scene.cameras.main.centerY;this.background=this.scene.add.image(t,s,"prompt_bg").setOrigin(.5).setScale(1.2),this.titleText=this.scene.add.text(t,s-40,"",{font:"32px montserrat-memo",color:"#FFFFFF",align:"center"}).setOrigin(.5),this.goalText=this.scene.add.text(t,s+20,"",{font:"26px montserrat-memo",color:"#FEC647",align:"center"}).setOrigin(.5),this.continueButton=this.scene.add.text(t,s+90,"Continuar",{font:"26px montserrat-memo",color:"#FFFFFF",backgroundColor:"#002E55",padding:{left:20,right:20,top:10,bottom:10},align:"center"}).setOrigin(.5).setInteractive({useHandCursor:!0}),this.continueButton.on("pointerdown",()=>{this.container.setVisible(!1),this.emit("closed")}),this.container=this.scene.add.container(0,0,[this.background,this.titleText,this.goalText,this.continueButton]).setDepth(1e3).setVisible(!1)}show(e,t){this.titleText.setText(`¡Nivel ${e}!`),this.goalText.setText(`Meta: ${t} puntos`),this.container.setVisible(!0),this.createConfettiEmitter()}}t.LevelUpScreen=o},852:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonEventHandler=void 0;var i=s(898);Object.defineProperty(t,"ButtonEventHandler",{enumerable:!0,get:function(){return i.ButtonEventHandler}})},856:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=s(317),a=s(927);class o extends Phaser.Scene{constructor(){super({key:"LeavingGameScene"})}create(){const e=new i.RetryScreen(this);e.addMask(),e.show(a.prompt.leaving,"prompt_screen")}}t.default=o,o.Name="LeavingGameScene"},891:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PromptScreen=void 0;const a=i(s(509)),o=s(701);class n extends a.default{constructor(e){super(e),this.actions=[]}setSplashBackground(){super.setSplashBackground()}addMask(){super.addMask()}setBackground(e,t=0,s=0,i=1,a=1){this.background=this.scene.add.image(this.scene.cameras.main.centerX+t,this.scene.cameras.main.centerY+s,e).setOrigin(.5,.5).setDepth(10).setScale(i,a)}setTitle(e,t=0,s=0,i=1,a=1){this.promptTitle=this.scene.add.image(this.scene.cameras.main.centerX+t,this.scene.cameras.main.centerY+s,e).setOrigin(.5,.5).setDepth(10).setScale(i,a)}setMessage(e,t=0,s=0,i=1,a=1){this.promptMessage=this.scene.add.image(this.scene.cameras.main.centerX+t,this.scene.cameras.main.centerY+s,e).setOrigin(.5,.5).setDepth(10).setScale(i,a)}setActions(e,t=0,s=0,i=0,a=1,n=1){e.forEach((e,r)=>{const c=new o.Button(this.scene,this.scene.cameras.main.centerX+t,this.scene.cameras.main.centerY+s+r*i,e,a,n);c.createButton(),this.actions.push(c)})}show(){}hide(){this.promptTitle.destroy(),this.promptMessage.destroy(),this.background.destroy(),this.actions.forEach(e=>e.destroy())}}t.PromptScreen=n},898:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonEventHandler=void 0;class s{static handleButtonEvents(e,t){let i=t.sound.add("cash");switch(e){case"close":s.handleCloseEvent(t);break;case"back":s.handleBackEvent(t);break;case"exit":t.game.onCloseGame&&t.game.onCloseGame(),window.location.href="https://arcorencasa.com/tienda/";break;case"retry":s.handlePlayAgain(t);break;case"copy":s.handleCopyCode(t),i.play();break;default:console.log("Botón no reconocido:",e)}}static handleCloseEvent(e){e.scene.launch("LeavingGameScene"),e.scene.pause()}static handleBackEvent(e){e.scene.resume(),e.scene.stop("LeavingGameScene")}static handlePlayAgain(e){e.scene.stop("MainMenu"),e.scene.restart()}static fallbackCopyTextToClipboard(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.select();try{document.execCommand("copy"),console.log("Texto copiado usando el fallback")}catch(e){console.error("Error al copiar el texto usando el fallback",e)}document.body.removeChild(t)}static handleCopyCode(e){const t=e.game.selectedCoupon;navigator.clipboard?navigator.clipboard.writeText(t).then(()=>{}).catch(e=>{s.fallbackCopyTextToClipboard(t)}):s.fallbackCopyTextToClipboard(t)}}t.ButtonEventHandler=s},924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static Log(e){console.log((new Date).toISOString()+" : "+e)}static LogSceneMethodEntry(e,t){this.Log("Entered "+e+" "+t+"()")}}},927:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,a)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(437),t)},982:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),o=i(s(724));class n extends Phaser.Scene{create(){a.default.LogSceneMethodEntry("MainSettings","create");const e=this.cameras.main.height/4,t=this.add.text(this.cameras.main.centerX,2*e,"Go Back");t.setOrigin(.5).setFontFamily("monospace").setFontSize(25).setFill("#fff").setInteractive(),t.on("pointerdown",()=>{this.scene.start(o.default.Name)},this)}}t.default=n,n.Name="MainSettings"}},t={};!function s(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}(552)})();
//# sourceMappingURL=app.js.map